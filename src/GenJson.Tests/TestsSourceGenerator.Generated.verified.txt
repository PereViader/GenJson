[  
#nullable enable
namespace GenJson
{
    using System;
    using System.Globalization;
    using System.Text;

    internal static class GenJsonParser
    {
        public static void SkipWhitespace(ReadOnlySpan<char> json, ref int index)
        {
            while (index < json.Length && char.IsWhiteSpace(json[index]))
            {
                index++;
            }
        }

        public static void Expect(ReadOnlySpan<char> json, ref int index, char expected)
        {
            SkipWhitespace(json, ref index);
            if (index >= json.Length || json[index] != expected)
            {
                throw new Exception($"Expected '{expected}' at {index}");
            }
            index++;
        }

        public static string ParseString(ReadOnlySpan<char> json, ref int index)
        {
            Expect(json, ref index, '"');
            var sb = new StringBuilder();
            while (index < json.Length)
            {
                var c = json[index++];
                if (c == '"') return sb.ToString();
                if (c == '\\')
                {
                    if (index >= json.Length) throw new Exception("Unexpected end of json string at " + index);
                    c = json[index++];
                    switch (c)
                    {
                        case '"': sb.Append('"'); break;
                        case '\\': sb.Append('\\'); break;
                        case '/': sb.Append('/'); break;
                        case 'b': sb.Append('\b'); break;
                        case 'f': sb.Append('\f'); break;
                        case 'n': sb.Append('\n'); break;
                        case 'r': sb.Append('\r'); break;
                        case 't': sb.Append('\t'); break;
                        case 'u': // Unicode escape
                            if (index + 4 > json.Length) throw new Exception("Invalid unicode escape at " + index);
                            var hexSequence = json.Slice(index, 4);
                            index += 4;
                            sb.Append((char)int.Parse(hexSequence, NumberStyles.HexNumber));
                            break;
                        default: sb.Append(c); break;
                    }
                }
                else
                {
                    sb.Append(c);
                }
            }
            throw new Exception("Unterminated string at " + index);
        }

        public static char ParseChar(ReadOnlySpan<char> json, ref int index)
        {
            var s = ParseString(json, ref index);
            if (s.Length != 1) throw new Exception("Expected string of length 1 for char at " + index);
            return s[0];
        }

        public static int ParseInt(ReadOnlySpan<char> json, ref int index) => (int)ParseLong(json, ref index);
        public static uint ParseUInt(ReadOnlySpan<char> json, ref int index) => (uint)ParseLong(json, ref index);
        public static short ParseShort(ReadOnlySpan<char> json, ref int index) => (short)ParseLong(json, ref index);
        public static ushort ParseUShort(ReadOnlySpan<char> json, ref int index) => (ushort)ParseLong(json, ref index);
        public static byte ParseByte(ReadOnlySpan<char> json, ref int index) => (byte)ParseLong(json, ref index);
        public static sbyte ParseSByte(ReadOnlySpan<char> json, ref int index) => (sbyte)ParseLong(json, ref index);

        public static long ParseLong(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            int start = index;
            if (index < json.Length && json[index] == '-') index++;
            while (index < json.Length && char.IsDigit(json[index])) index++;
            var slice = json.Slice(start, index - start);
            return long.Parse(slice);
        }
        
        public static ulong ParseULong(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            int start = index;
            while (index < json.Length && char.IsDigit(json[index])) index++;
            var slice = json.Slice(start, index - start);
            return ulong.Parse(slice);
        }

        public static double ParseDouble(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            int start = index;
            if (index < json.Length && json[index] == '-') index++;
            while (index < json.Length && (char.IsDigit(json[index]) || json[index] == '.' || json[index] == 'e' || json[index] == 'E' || json[index] == '+' || json[index] == '-')) index++;
            var slice = json.Slice(start, index - start);
            return double.Parse(slice, CultureInfo.InvariantCulture);
        }
        
        public static float ParseFloat(ReadOnlySpan<char> json, ref int index) => (float)ParseDouble(json, ref index);

        public static decimal ParseDecimal(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            int start = index;
            if (index < json.Length && json[index] == '-') index++;
            while (index < json.Length && (char.IsDigit(json[index]) || json[index] == '.' || json[index] == 'e' || json[index] == 'E' || json[index] == '+' || json[index] == '-')) index++;
            var slice = json.Slice(start, index - start);
            return decimal.Parse(slice, CultureInfo.InvariantCulture);
        }

        public static bool ParseBoolean(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            if (json.Length - index >= 4 && json.Slice(index, 4).SequenceEqual("true"))
            {
                index += 4;
                return true;
            }
            if (json.Length - index >= 5 && json.Slice(index, 5).SequenceEqual("false"))
            {
                index += 5;
                return false;
            }
            throw new Exception("Expected boolean at " + index);
        }

        public static bool IsNull(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            return json.Length - index >= 4 && json.Slice(index, 4).SequenceEqual("null");
        }

        public static void ParseNull(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            if (json.Length - index >= 4 && json.Slice(index, 4).SequenceEqual("null"))
            {
                index += 4;
                return;
            }
             throw new Exception("Expected null at " + index);
        }
        
        public static void SkipValue(ReadOnlySpan<char> json, ref int index)
        {
            SkipWhitespace(json, ref index);
            if (index >= json.Length) return;
            char c = json[index];
            if (c == '"')
            {
                ParseString(json, ref index);
            }
            else if (c == '{')
            {
                index++;
                while (index < json.Length)
                {
                    SkipWhitespace(json, ref index);
                    if (json[index] == '}')
                    {
                        index++;
                        return;
                    }
                    SkipValue(json, ref index); // Key (string) is a value
                    SkipWhitespace(json, ref index);
                    if (json[index] == ':') index++;
                    SkipValue(json, ref index); // Value
                    SkipWhitespace(json, ref index);
                    if (json[index] == ',') index++;
                }
            }
            else if (c == '[')
            {
                index++;
                while (index < json.Length)
                {
                    SkipWhitespace(json, ref index);
                    if (json[index] == ']')
                    {
                        index++;
                        return;
                    }
                    SkipValue(json, ref index);
                    SkipWhitespace(json, ref index);
                    if (json[index] == ',') index++;
                }
            }
            else if (char.IsDigit(c) || c == '-')
            {
                if (c == '-') index++;
                while (index < json.Length && (char.IsDigit(json[index]) || json[index] == '.' || json[index] == 'e' || json[index] == 'E' || json[index] == '+' || json[index] == '-')) index++;
            }
            else if (c == 't') // true
            {
                index += 4;
            }
            else if (c == 'f') // false
            {
                index += 5;
            }
            else if (c == 'n') // null
            {
                index += 4;
            }
            else
            {
                index++; // Unknown
            }
        }
    }
    internal static class GenJsonSizeHelper
    {
        public static int GetSize(int value)
        {
            if (value == 0) return 1;
            if (value == int.MinValue) return 11;
            if (value < 0) return 1 + GetSize(-value);
            if (value < 10) return 1;
            if (value < 100) return 2;
            if (value < 1000) return 3;
            if (value < 10000) return 4;
            if (value < 100000) return 5;
            if (value < 1000000) return 6;
            if (value < 10000000) return 7;
            if (value < 100000000) return 8;
            if (value < 1000000000) return 9;
            return 10;
        }

        public static int GetSize(long value)
        {
            if (value == 0) return 1;
            if (value == long.MinValue) return 20;
            if (value < 0) return 1 + GetSize(-value);
            if (value < 10L) return 1;
            if (value < 100L) return 2;
            if (value < 1000L) return 3;
            if (value < 10000L) return 4;
            if (value < 100000L) return 5;
            if (value < 1000000L) return 6;
            if (value < 10000000L) return 7;
            if (value < 100000000L) return 8;
            if (value < 1000000000L) return 9;
            if (value < 10000000000L) return 10;
            if (value < 100000000000L) return 11;
            if (value < 1000000000000L) return 12;
            if (value < 10000000000000L) return 13;
            if (value < 100000000000000L) return 14;
            if (value < 1000000000000000L) return 15;
            if (value < 10000000000000000L) return 16;
            if (value < 100000000000000000L) return 17;
            if (value < 1000000000000000000L) return 18;
            return 19;
        }
        
        public static int GetSize(bool value) => value ? 4 : 5;
        public static int GetSize(char value) => 3; // "c"
        public static int GetSize(string? value) => value is null ? 0 : value.Length + 2;

        public static int GetSize(Guid value) => 38;

        public static int GetSize(double value)
        {
#if NETSTANDARD2_1_OR_GREATER || NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written, default, global::System.Globalization.CultureInfo.InvariantCulture))
            {
                return written;
            }
#endif
            return value.ToString(global::System.Globalization.CultureInfo.InvariantCulture).Length;
        }

        public static int GetSize(float value)
        {
#if NETSTANDARD2_1_OR_GREATER || NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written, default, global::System.Globalization.CultureInfo.InvariantCulture))
            {
                return written;
            }
#endif
            return value.ToString(global::System.Globalization.CultureInfo.InvariantCulture).Length;
        }

        public static int GetSize(decimal value)
        {
#if NETSTANDARD2_1_OR_GREATER || NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written, default, global::System.Globalization.CultureInfo.InvariantCulture))
            {
                return written;
            }
#endif
            return value.ToString(global::System.Globalization.CultureInfo.InvariantCulture).Length;
        }

        public static int GetSize(DateTime value)
        {
#if NETSTANDARD2_1_OR_GREATER || NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written, "O", global::System.Globalization.CultureInfo.InvariantCulture))
            {
                return written + 2;
            }
#endif
            return value.ToString("O", global::System.Globalization.CultureInfo.InvariantCulture).Length + 2;
        }

        public static int GetSize(DateTimeOffset value)
        {
#if NETSTANDARD2_1_OR_GREATER || NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written, "O", global::System.Globalization.CultureInfo.InvariantCulture))
            {
                return written + 2;
            }
#endif
            return value.ToString("O", global::System.Globalization.CultureInfo.InvariantCulture).Length + 2;
        }

        public static int GetSize(TimeSpan value)
        {
#if NETSTANDARD2_1_OR_GREATER || NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written, "c", global::System.Globalization.CultureInfo.InvariantCulture))
            {
                return written + 2;
            }
#endif
            return value.ToString("c", global::System.Globalization.CultureInfo.InvariantCulture).Length + 2;
        }



        public static int GetSize(Version value)
        {
#if NET6_0_OR_GREATER
            Span<char> buffer = stackalloc char[128];
            if (value.TryFormat(buffer, out int written))
            {
                return written + 2;
            }
#endif
            return value.ToString().Length + 2;
        }
    }
}
  
namespace GenJson.Tests
{
    partial class EmptyClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            if (this.Value is not null)
            {
                propertyCount++;
                size += 8;
                if (this.Value is null)
                {
                    size += 4;
                }
                else
                {
                    size += global::GenJson.GenJsonSizeHelper.GetSize(this.Value.Value);
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            if (this.Value is not null)
            {
                sb.Append("\"Value\":");
                if (this.Value is null)
                {
                    sb.Append("null");
                }
                else
                {
                    sb.Append(this.Value.Value);
                }
            }
            sb.Append("}");
        }

        public static EmptyClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static EmptyClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            int? _Value = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new EmptyClass
                    {
                        Value = _Value,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Value":
                        if (global::GenJson.GenJsonParser.IsNull(json, ref index))
                        {
                            global::GenJson.GenJsonParser.ParseNull(json, ref index);
                            _Value = null;
                        }
                        else
                        {
                            _Value = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class StringClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 10;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Present);
            if (this.NullablePresent is not null)
            {
                propertyCount++;
                size += 18;
                size += global::GenJson.GenJsonSizeHelper.GetSize(this.NullablePresent);
            }
            if (this.NullableNull is not null)
            {
                propertyCount++;
                size += 15;
                size += global::GenJson.GenJsonSizeHelper.GetSize(this.NullableNull);
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"Present\":");
            sb.Append("\"");
            sb.Append(this.Present);
            sb.Append("\"");
            if (this.NullablePresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullablePresent\":");
                sb.Append("\"");
                sb.Append(this.NullablePresent);
                sb.Append("\"");
            }
            if (this.NullableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableNull\":");
                sb.Append("\"");
                sb.Append(this.NullableNull);
                sb.Append("\"");
            }
            sb.Append("}");
        }

        public static StringClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static StringClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            string _Present = default;
            string _NullablePresent = default;
            string _NullableNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new StringClass
                    {
                        Present = _Present,
                        NullablePresent = _NullablePresent,
                        NullableNull = _NullableNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Present":
                        _Present = global::GenJson.GenJsonParser.ParseString(json, ref index);
                        break;
                    case "NullablePresent":
                        _NullablePresent = global::GenJson.GenJsonParser.ParseString(json, ref index);
                        break;
                    case "NullableNull":
                        _NullableNull = global::GenJson.GenJsonParser.ParseString(json, ref index);
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class IntClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 10;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Present);
            if (this.NullablePresent is not null)
            {
                propertyCount++;
                size += 18;
                if (this.NullablePresent is null)
                {
                    size += 4;
                }
                else
                {
                    size += global::GenJson.GenJsonSizeHelper.GetSize(this.NullablePresent.Value);
                }
            }
            if (this.NullableNull is not null)
            {
                propertyCount++;
                size += 15;
                if (this.NullableNull is null)
                {
                    size += 4;
                }
                else
                {
                    size += global::GenJson.GenJsonSizeHelper.GetSize(this.NullableNull.Value);
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"Present\":");
            sb.Append(this.Present);
            if (this.NullablePresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullablePresent\":");
                if (this.NullablePresent is null)
                {
                    sb.Append("null");
                }
                else
                {
                    sb.Append(this.NullablePresent.Value);
                }
            }
            if (this.NullableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableNull\":");
                if (this.NullableNull is null)
                {
                    sb.Append("null");
                }
                else
                {
                    sb.Append(this.NullableNull.Value);
                }
            }
            sb.Append("}");
        }

        public static IntClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static IntClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            int _Present = default;
            int? _NullablePresent = default;
            int? _NullableNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new IntClass
                    {
                        Present = _Present,
                        NullablePresent = _NullablePresent,
                        NullableNull = _NullableNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Present":
                        _Present = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        break;
                    case "NullablePresent":
                        if (global::GenJson.GenJsonParser.IsNull(json, ref index))
                        {
                            global::GenJson.GenJsonParser.ParseNull(json, ref index);
                            _NullablePresent = null;
                        }
                        else
                        {
                            _NullablePresent = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        }
                        break;
                    case "NullableNull":
                        if (global::GenJson.GenJsonParser.IsNull(json, ref index))
                        {
                            global::GenJson.GenJsonParser.ParseNull(json, ref index);
                            _NullableNull = null;
                        }
                        else
                        {
                            _NullableNull = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class IntEnumClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 16;
            size += global::GenJson.GenJsonSizeHelper.GetSize((int)this.PresentNumber);
            propertyCount++;
            size += 14;
            size += this.PresentText.ToString().Length + 2;
            propertyCount++;
            size += 24;
            size += global::GenJson.GenJsonSizeHelper.GetSize((int)this.NullablePresentNumber);
            if (this.NullableNull is not null)
            {
                propertyCount++;
                size += 15;
                if (this.NullableNull is null)
                {
                    size += 4;
                }
                else
                {
                    size += global::GenJson.GenJsonSizeHelper.GetSize((int)this.NullableNull.Value);
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"PresentNumber\":");
            sb.Append((int)this.PresentNumber);
            sb.Append(",");
            sb.Append("\"PresentText\":");
            sb.Append("\"");
            sb.Append(this.PresentText.ToString());
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"NullablePresentNumber\":");
            sb.Append((int)this.NullablePresentNumber);
            if (this.NullableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableNull\":");
                if (this.NullableNull is null)
                {
                    sb.Append("null");
                }
                else
                {
                    sb.Append((int)this.NullableNull.Value);
                }
            }
            sb.Append("}");
        }

        public static IntEnumClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static IntEnumClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::GenJson.Tests.IntEnum _PresentNumber = default;
            global::GenJson.Tests.IntEnum _PresentText = default;
            global::GenJson.Tests.IntEnum _NullablePresentNumber = default;
            global::GenJson.Tests.IntEnum? _NullableNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new IntEnumClass
                    {
                        PresentNumber = _PresentNumber,
                        PresentText = _PresentText,
                        NullablePresentNumber = _NullablePresentNumber,
                        NullableNull = _NullableNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "PresentNumber":
                        _PresentNumber = (global::GenJson.Tests.IntEnum)global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        break;
                    case "PresentText":
                        _PresentText = System.Enum.Parse<global::GenJson.Tests.IntEnum>(global::GenJson.GenJsonParser.ParseString(json, ref index));
                        break;
                    case "NullablePresentNumber":
                        _NullablePresentNumber = (global::GenJson.Tests.IntEnum)global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        break;
                    case "NullableNull":
                        if (global::GenJson.GenJsonParser.IsNull(json, ref index))
                        {
                            global::GenJson.GenJsonParser.ParseNull(json, ref index);
                            _NullableNull = null;
                        }
                        else
                        {
                            _NullableNull = (global::GenJson.Tests.IntEnum)global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class ByteEnumClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 10;
            size += global::GenJson.GenJsonSizeHelper.GetSize((byte)this.Present);
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"Present\":");
            sb.Append((byte)this.Present);
            sb.Append("}");
        }

        public static ByteEnumClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static ByteEnumClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::GenJson.Tests.ByteEnum _Present = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new ByteEnumClass
                    {
                        Present = _Present,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Present":
                        _Present = (global::GenJson.Tests.ByteEnum)global::GenJson.GenJsonParser.ParseByte(json, ref index);
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class ParentClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 10;
            size += this.Present.CalculateJsonSize();
            if (this.NullablePresent is not null)
            {
                propertyCount++;
                size += 18;
                size += this.NullablePresent.CalculateJsonSize();
            }
            if (this.NullableNull is not null)
            {
                propertyCount++;
                size += 15;
                size += this.NullableNull.CalculateJsonSize();
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"Present\":");
            this.Present.ToJson(sb);
            if (this.NullablePresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullablePresent\":");
                this.NullablePresent.ToJson(sb);
            }
            if (this.NullableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableNull\":");
                this.NullableNull.ToJson(sb);
            }
            sb.Append("}");
        }

        public static ParentClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static ParentClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::GenJson.Tests.EmptyClass _Present = default;
            global::GenJson.Tests.EmptyClass _NullablePresent = default;
            global::GenJson.Tests.EmptyClass _NullableNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new ParentClass
                    {
                        Present = _Present,
                        NullablePresent = _NullablePresent,
                        NullableNull = _NullableNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Present":
                        _Present = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                        break;
                    case "NullablePresent":
                        _NullablePresent = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                        break;
                    case "NullableNull":
                        _NullableNull = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class EnumerableIntClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 20;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.EnumerablePresent)
                {
                    count0++;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 15;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.ArrayPresent)
                {
                    count0++;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 14;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.ListPresent)
                {
                    count0++;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                }
                if (count0 > 1) size += count0 - 1;
            }
            if (this.NullableEnumerablePresent is not null)
            {
                propertyCount++;
                size += 28;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableEnumerablePresent)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableArrayPresent is not null)
            {
                propertyCount++;
                size += 23;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableArrayPresent)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableListPresent is not null)
            {
                propertyCount++;
                size += 22;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableListPresent)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableEnumerableNull is not null)
            {
                propertyCount++;
                size += 25;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableEnumerableNull)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableArrayNull is not null)
            {
                propertyCount++;
                size += 20;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableArrayNull)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableListNull is not null)
            {
                propertyCount++;
                size += 19;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableListNull)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"EnumerablePresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.EnumerablePresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append(item0);
                }
                sb.Append("]");
            }
            sb.Append(",");
            sb.Append("\"ArrayPresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.ArrayPresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append(item0);
                }
                sb.Append("]");
            }
            sb.Append(",");
            sb.Append("\"ListPresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.ListPresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append(item0);
                }
                sb.Append("]");
            }
            if (this.NullableEnumerablePresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableEnumerablePresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableEnumerablePresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append(item0);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableArrayPresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableArrayPresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableArrayPresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append(item0);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableListPresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableListPresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableListPresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append(item0);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableEnumerableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableEnumerableNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableEnumerableNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append(item0);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableArrayNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableArrayNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableArrayNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append(item0);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableListNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableListNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableListNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append(item0);
                    }
                    sb.Append("]");
                }
            }
            sb.Append("}");
        }

        public static EnumerableIntClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static EnumerableIntClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::System.Collections.Generic.IEnumerable<int> _EnumerablePresent = default;
            int[] _ArrayPresent = default;
            global::System.Collections.Generic.List<int> _ListPresent = default;
            global::System.Collections.Generic.IEnumerable<int> _NullableEnumerablePresent = default;
            int[] _NullableArrayPresent = default;
            global::System.Collections.Generic.List<int> _NullableListPresent = default;
            global::System.Collections.Generic.IEnumerable<int> _NullableEnumerableNull = default;
            int[] _NullableArrayNull = default;
            global::System.Collections.Generic.List<int> _NullableListNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new EnumerableIntClass
                    {
                        EnumerablePresent = _EnumerablePresent,
                        ArrayPresent = _ArrayPresent,
                        ListPresent = _ListPresent,
                        NullableEnumerablePresent = _NullableEnumerablePresent,
                        NullableArrayPresent = _NullableArrayPresent,
                        NullableListPresent = _NullableListPresent,
                        NullableEnumerableNull = _NullableEnumerableNull,
                        NullableArrayNull = _NullableArrayNull,
                        NullableListNull = _NullableListNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "EnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _EnumerablePresent = list0;
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "ArrayPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _ArrayPresent = list0.ToArray();
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "ListPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _ListPresent = list0;
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableEnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableEnumerablePresent = list0;
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableArrayPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableArrayPresent = list0.ToArray();
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableListPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableListPresent = list0;
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableEnumerableNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableEnumerableNull = list0;
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableArrayNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableArrayNull = list0.ToArray();
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableListNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableListNull = list0;
                                    break;
                                }
                                int item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class EnumerableStringClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 20;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.EnumerablePresent)
                {
                    count0++;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 15;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.ArrayPresent)
                {
                    count0++;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 14;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.ListPresent)
                {
                    count0++;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                }
                if (count0 > 1) size += count0 - 1;
            }
            if (this.NullableEnumerablePresent is not null)
            {
                propertyCount++;
                size += 28;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableEnumerablePresent)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableArrayPresent is not null)
            {
                propertyCount++;
                size += 23;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableArrayPresent)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableListPresent is not null)
            {
                propertyCount++;
                size += 22;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableListPresent)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableEnumerableNull is not null)
            {
                propertyCount++;
                size += 25;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableEnumerableNull)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableArrayNull is not null)
            {
                propertyCount++;
                size += 20;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableArrayNull)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableListNull is not null)
            {
                propertyCount++;
                size += 19;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableListNull)
                    {
                        count0++;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(item0);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"EnumerablePresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.EnumerablePresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(item0);
                    sb.Append("\"");
                }
                sb.Append("]");
            }
            sb.Append(",");
            sb.Append("\"ArrayPresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.ArrayPresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(item0);
                    sb.Append("\"");
                }
                sb.Append("]");
            }
            sb.Append(",");
            sb.Append("\"ListPresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.ListPresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(item0);
                    sb.Append("\"");
                }
                sb.Append("]");
            }
            if (this.NullableEnumerablePresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableEnumerablePresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableEnumerablePresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(item0);
                        sb.Append("\"");
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableArrayPresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableArrayPresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableArrayPresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(item0);
                        sb.Append("\"");
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableListPresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableListPresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableListPresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(item0);
                        sb.Append("\"");
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableEnumerableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableEnumerableNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableEnumerableNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(item0);
                        sb.Append("\"");
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableArrayNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableArrayNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableArrayNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(item0);
                        sb.Append("\"");
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableListNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableListNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableListNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(item0);
                        sb.Append("\"");
                    }
                    sb.Append("]");
                }
            }
            sb.Append("}");
        }

        public static EnumerableStringClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static EnumerableStringClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::System.Collections.Generic.IEnumerable<string> _EnumerablePresent = default;
            string[] _ArrayPresent = default;
            global::System.Collections.Generic.List<string> _ListPresent = default;
            global::System.Collections.Generic.IEnumerable<string> _NullableEnumerablePresent = default;
            string[] _NullableArrayPresent = default;
            global::System.Collections.Generic.List<string> _NullableListPresent = default;
            global::System.Collections.Generic.IEnumerable<string> _NullableEnumerableNull = default;
            string[] _NullableArrayNull = default;
            global::System.Collections.Generic.List<string> _NullableListNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new EnumerableStringClass
                    {
                        EnumerablePresent = _EnumerablePresent,
                        ArrayPresent = _ArrayPresent,
                        ListPresent = _ListPresent,
                        NullableEnumerablePresent = _NullableEnumerablePresent,
                        NullableArrayPresent = _NullableArrayPresent,
                        NullableListPresent = _NullableListPresent,
                        NullableEnumerableNull = _NullableEnumerableNull,
                        NullableArrayNull = _NullableArrayNull,
                        NullableListNull = _NullableListNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "EnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _EnumerablePresent = list0;
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "ArrayPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _ArrayPresent = list0.ToArray();
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "ListPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _ListPresent = list0;
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableEnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableEnumerablePresent = list0;
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableArrayPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableArrayPresent = list0.ToArray();
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableListPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableListPresent = list0;
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableEnumerableNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableEnumerableNull = list0;
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableArrayNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableArrayNull = list0.ToArray();
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableListNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableListNull = list0;
                                    break;
                                }
                                string item0 = default;
                                item0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class EnumerableParentClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 20;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.EnumerablePresent)
                {
                    count0++;
                    size += item0.CalculateJsonSize();
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 15;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.ArrayPresent)
                {
                    count0++;
                    size += item0.CalculateJsonSize();
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 14;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.ListPresent)
                {
                    count0++;
                    size += item0.CalculateJsonSize();
                }
                if (count0 > 1) size += count0 - 1;
            }
            if (this.NullableEnumerablePresent is not null)
            {
                propertyCount++;
                size += 28;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableEnumerablePresent)
                    {
                        count0++;
                        size += item0.CalculateJsonSize();
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableArrayPresent is not null)
            {
                propertyCount++;
                size += 23;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableArrayPresent)
                    {
                        count0++;
                        size += item0.CalculateJsonSize();
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableListPresent is not null)
            {
                propertyCount++;
                size += 22;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableListPresent)
                    {
                        count0++;
                        size += item0.CalculateJsonSize();
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableEnumerableNull is not null)
            {
                propertyCount++;
                size += 25;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableEnumerableNull)
                    {
                        count0++;
                        size += item0.CalculateJsonSize();
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableArrayNull is not null)
            {
                propertyCount++;
                size += 20;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableArrayNull)
                    {
                        count0++;
                        size += item0.CalculateJsonSize();
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (this.NullableListNull is not null)
            {
                propertyCount++;
                size += 19;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var item0 in this.NullableListNull)
                    {
                        count0++;
                        size += item0.CalculateJsonSize();
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"EnumerablePresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.EnumerablePresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    item0.ToJson(sb);
                }
                sb.Append("]");
            }
            sb.Append(",");
            sb.Append("\"ArrayPresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.ArrayPresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    item0.ToJson(sb);
                }
                sb.Append("]");
            }
            sb.Append(",");
            sb.Append("\"ListPresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.ListPresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    item0.ToJson(sb);
                }
                sb.Append("]");
            }
            if (this.NullableEnumerablePresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableEnumerablePresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableEnumerablePresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        item0.ToJson(sb);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableArrayPresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableArrayPresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableArrayPresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        item0.ToJson(sb);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableListPresent is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableListPresent\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableListPresent)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        item0.ToJson(sb);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableEnumerableNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableEnumerableNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableEnumerableNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        item0.ToJson(sb);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableArrayNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableArrayNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableArrayNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        item0.ToJson(sb);
                    }
                    sb.Append("]");
                }
            }
            if (this.NullableListNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableListNull\":");
                {
                    sb.Append("[");
                    bool firstItem0 = true;
                    foreach (var item0 in this.NullableListNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        item0.ToJson(sb);
                    }
                    sb.Append("]");
                }
            }
            sb.Append("}");
        }

        public static EnumerableParentClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static EnumerableParentClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::System.Collections.Generic.IEnumerable<global::GenJson.Tests.EmptyClass> _EnumerablePresent = default;
            global::GenJson.Tests.EmptyClass[] _ArrayPresent = default;
            global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass> _ListPresent = default;
            global::System.Collections.Generic.IEnumerable<global::GenJson.Tests.EmptyClass> _NullableEnumerablePresent = default;
            global::GenJson.Tests.EmptyClass[] _NullableArrayPresent = default;
            global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass> _NullableListPresent = default;
            global::System.Collections.Generic.IEnumerable<global::GenJson.Tests.EmptyClass> _NullableEnumerableNull = default;
            global::GenJson.Tests.EmptyClass[] _NullableArrayNull = default;
            global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass> _NullableListNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new EnumerableParentClass
                    {
                        EnumerablePresent = _EnumerablePresent,
                        ArrayPresent = _ArrayPresent,
                        ListPresent = _ListPresent,
                        NullableEnumerablePresent = _NullableEnumerablePresent,
                        NullableArrayPresent = _NullableArrayPresent,
                        NullableListPresent = _NullableListPresent,
                        NullableEnumerableNull = _NullableEnumerableNull,
                        NullableArrayNull = _NullableArrayNull,
                        NullableListNull = _NullableListNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "EnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _EnumerablePresent = list0;
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "ArrayPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _ArrayPresent = list0.ToArray();
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "ListPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _ListPresent = list0;
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableEnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableEnumerablePresent = list0;
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableArrayPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableArrayPresent = list0.ToArray();
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableListPresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableListPresent = list0;
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableEnumerableNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableEnumerableNull = list0;
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableArrayNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableArrayNull = list0.ToArray();
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableListNull":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _NullableListNull = list0;
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass item0 = default;
                                item0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class NestedEnumerableClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 20;
            {
                size += 2;
                int count0 = 0;
                foreach (var item0 in this.EnumerablePresent)
                {
                    count0++;
                    {
                        size += 2;
                        int count1 = 0;
                        foreach (var item1 in item0)
                        {
                            count1++;
                            size += item1.CalculateJsonSize();
                        }
                        if (count1 > 1) size += count1 - 1;
                    }
                }
                if (count0 > 1) size += count0 - 1;
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"EnumerablePresent\":");
            {
                sb.Append("[");
                bool firstItem0 = true;
                foreach (var item0 in this.EnumerablePresent)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    {
                        sb.Append("[");
                        bool firstItem1 = true;
                        foreach (var item1 in item0)
                        {
                            if (!firstItem1)
                            {
                                sb.Append(",");
                            }
                            firstItem1 = false;
                            item1.ToJson(sb);
                        }
                        sb.Append("]");
                    }
                }
                sb.Append("]");
            }
            sb.Append("}");
        }

        public static NestedEnumerableClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static NestedEnumerableClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::GenJson.Tests.EmptyClass[][] _EnumerablePresent = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new NestedEnumerableClass
                    {
                        EnumerablePresent = _EnumerablePresent,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "EnumerablePresent":
                        {
                            var list0 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass[]>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ']')
                                {
                                    index++;
                                    _EnumerablePresent = list0.ToArray();
                                    break;
                                }
                                global::GenJson.Tests.EmptyClass[] item0 = default;
                                {
                                    var list1 = new global::System.Collections.Generic.List<global::GenJson.Tests.EmptyClass>();
                                    global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                                    while (index < json.Length)
                                    {
                                        global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                        if (json[index] == ']')
                                        {
                                            index++;
                                            item0 = list1.ToArray();
                                            break;
                                        }
                                        global::GenJson.Tests.EmptyClass item1 = default;
                                        item1 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                        list1.Add(item1);
                                        global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                        if (json[index] == ',')
                                        {
                                            index++;
                                        }
                                    }
                                }
                                list0.Add(item0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class DictionaryClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 16;
            {
                size += 2;
                int count0 = 0;
                foreach (var kvp0 in this.PresentIntInt)
                {
                    count0++;
                    size += 3;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key);
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Value);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 19;
            {
                size += 2;
                int count0 = 0;
                foreach (var kvp0 in this.PresentIntString)
                {
                    count0++;
                    size += 3;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key);
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Value);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 19;
            {
                size += 2;
                int count0 = 0;
                foreach (var kvp0 in this.PresentStringInt)
                {
                    count0++;
                    size += 3;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key) - 2;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Value);
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 26;
            {
                size += 2;
                int count0 = 0;
                foreach (var kvp0 in this.PresentIntEnumerableInt)
                {
                    count0++;
                    size += 3;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key);
                    {
                        size += 2;
                        int count1 = 0;
                        foreach (var item1 in kvp0.Value)
                        {
                            count1++;
                            size += global::GenJson.GenJsonSizeHelper.GetSize(item1);
                        }
                        if (count1 > 1) size += count1 - 1;
                    }
                }
                if (count0 > 1) size += count0 - 1;
            }
            propertyCount++;
            size += 35;
            {
                size += 2;
                int count0 = 0;
                foreach (var kvp0 in this.PresentDictionaryIntEmptyClasses)
                {
                    count0++;
                    size += 3;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key);
                    size += kvp0.Value.CalculateJsonSize();
                }
                if (count0 > 1) size += count0 - 1;
            }
            if (this.NullableDictionaryIntIntNull is not null)
            {
                propertyCount++;
                size += 31;
                {
                    size += 2;
                    int count0 = 0;
                    foreach (var kvp0 in this.NullableDictionaryIntIntNull)
                    {
                        count0++;
                        size += 3;
                        size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key);
                        size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Value);
                    }
                    if (count0 > 1) size += count0 - 1;
                }
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"PresentIntInt\":");
            {
                sb.Append("{");
                bool firstItem0 = true;
                foreach (var kvp0 in this.PresentIntInt)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(kvp0.Key);
                    sb.Append("\":");
                    sb.Append(kvp0.Value);
                }
                sb.Append("}");
            }
            sb.Append(",");
            sb.Append("\"PresentIntString\":");
            {
                sb.Append("{");
                bool firstItem0 = true;
                foreach (var kvp0 in this.PresentIntString)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(kvp0.Key);
                    sb.Append("\":");
                    sb.Append("\"");
                    sb.Append(kvp0.Value);
                    sb.Append("\"");
                }
                sb.Append("}");
            }
            sb.Append(",");
            sb.Append("\"PresentStringInt\":");
            {
                sb.Append("{");
                bool firstItem0 = true;
                foreach (var kvp0 in this.PresentStringInt)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(kvp0.Key);
                    sb.Append("\":");
                    sb.Append(kvp0.Value);
                }
                sb.Append("}");
            }
            sb.Append(",");
            sb.Append("\"PresentIntEnumerableInt\":");
            {
                sb.Append("{");
                bool firstItem0 = true;
                foreach (var kvp0 in this.PresentIntEnumerableInt)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(kvp0.Key);
                    sb.Append("\":");
                    {
                        sb.Append("[");
                        bool firstItem1 = true;
                        foreach (var item1 in kvp0.Value)
                        {
                            if (!firstItem1)
                            {
                                sb.Append(",");
                            }
                            firstItem1 = false;
                            sb.Append(item1);
                        }
                        sb.Append("]");
                    }
                }
                sb.Append("}");
            }
            sb.Append(",");
            sb.Append("\"PresentDictionaryIntEmptyClasses\":");
            {
                sb.Append("{");
                bool firstItem0 = true;
                foreach (var kvp0 in this.PresentDictionaryIntEmptyClasses)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(kvp0.Key);
                    sb.Append("\":");
                    kvp0.Value.ToJson(sb);
                }
                sb.Append("}");
            }
            if (this.NullableDictionaryIntIntNull is not null)
            {
                sb.Append(",");
                sb.Append("\"NullableDictionaryIntIntNull\":");
                {
                    sb.Append("{");
                    bool firstItem0 = true;
                    foreach (var kvp0 in this.NullableDictionaryIntIntNull)
                    {
                        if (!firstItem0)
                        {
                            sb.Append(",");
                        }
                        firstItem0 = false;
                        sb.Append("\"");
                        sb.Append(kvp0.Key);
                        sb.Append("\":");
                        sb.Append(kvp0.Value);
                    }
                    sb.Append("}");
                }
            }
            sb.Append("}");
        }

        public static DictionaryClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static DictionaryClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::System.Collections.Generic.IReadOnlyDictionary<int, int> _PresentIntInt = default;
            global::System.Collections.Generic.IReadOnlyDictionary<int, string> _PresentIntString = default;
            global::System.Collections.Generic.IReadOnlyDictionary<string, int> _PresentStringInt = default;
            global::System.Collections.Generic.IReadOnlyDictionary<int, global::System.Collections.Generic.IEnumerable<int>> _PresentIntEnumerableInt = default;
            global::System.Collections.Generic.IReadOnlyDictionary<int, global::GenJson.Tests.EmptyClass> _PresentDictionaryIntEmptyClasses = default;
            global::System.Collections.Generic.IReadOnlyDictionary<int, int> _NullableDictionaryIntIntNull = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new DictionaryClass
                    {
                        PresentIntInt = _PresentIntInt,
                        PresentIntString = _PresentIntString,
                        PresentStringInt = _PresentStringInt,
                        PresentIntEnumerableInt = _PresentIntEnumerableInt,
                        PresentDictionaryIntEmptyClasses = _PresentDictionaryIntEmptyClasses,
                        NullableDictionaryIntIntNull = _NullableDictionaryIntIntNull,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "PresentIntInt":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<int, int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _PresentIntInt = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                int key0 = int.Parse(keyStr0);
                                int val0 = default;
                                val0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "PresentIntString":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<int, string>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _PresentIntString = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                int key0 = int.Parse(keyStr0);
                                string val0 = default;
                                val0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "PresentStringInt":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<string, int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _PresentStringInt = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                string key0 = keyStr0;
                                int val0 = default;
                                val0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "PresentIntEnumerableInt":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<int, global::System.Collections.Generic.IEnumerable<int>>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _PresentIntEnumerableInt = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                int key0 = int.Parse(keyStr0);
                                global::System.Collections.Generic.IEnumerable<int> val0 = default;
                                {
                                    var list1 = new global::System.Collections.Generic.List<int>();
                                    global::GenJson.GenJsonParser.Expect(json, ref index, '[');
                                    while (index < json.Length)
                                    {
                                        global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                        if (json[index] == ']')
                                        {
                                            index++;
                                            val0 = list1;
                                            break;
                                        }
                                        int item1 = default;
                                        item1 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                        list1.Add(item1);
                                        global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                        if (json[index] == ',')
                                        {
                                            index++;
                                        }
                                    }
                                }
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "PresentDictionaryIntEmptyClasses":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<int, global::GenJson.Tests.EmptyClass>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _PresentDictionaryIntEmptyClasses = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                int key0 = int.Parse(keyStr0);
                                global::GenJson.Tests.EmptyClass val0 = default;
                                val0 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    case "NullableDictionaryIntIntNull":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<int, int>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _NullableDictionaryIntIntNull = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                int key0 = int.Parse(keyStr0);
                                int val0 = default;
                                val0 = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class NestedDictionaryClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 10;
            {
                size += 2;
                int count0 = 0;
                foreach (var kvp0 in this.Present)
                {
                    count0++;
                    size += 3;
                    size += global::GenJson.GenJsonSizeHelper.GetSize(kvp0.Key);
                    {
                        size += 2;
                        int count1 = 0;
                        foreach (var kvp1 in kvp0.Value)
                        {
                            count1++;
                            size += 3;
                            size += global::GenJson.GenJsonSizeHelper.GetSize(kvp1.Key);
                            size += kvp1.Value.CalculateJsonSize();
                        }
                        if (count1 > 1) size += count1 - 1;
                    }
                }
                if (count0 > 1) size += count0 - 1;
            }
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"Present\":");
            {
                sb.Append("{");
                bool firstItem0 = true;
                foreach (var kvp0 in this.Present)
                {
                    if (!firstItem0)
                    {
                        sb.Append(",");
                    }
                    firstItem0 = false;
                    sb.Append("\"");
                    sb.Append(kvp0.Key);
                    sb.Append("\":");
                    {
                        sb.Append("{");
                        bool firstItem1 = true;
                        foreach (var kvp1 in kvp0.Value)
                        {
                            if (!firstItem1)
                            {
                                sb.Append(",");
                            }
                            firstItem1 = false;
                            sb.Append("\"");
                            sb.Append(kvp1.Key);
                            sb.Append("\":");
                            kvp1.Value.ToJson(sb);
                        }
                        sb.Append("}");
                    }
                }
                sb.Append("}");
            }
            sb.Append("}");
        }

        public static NestedDictionaryClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static NestedDictionaryClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            global::System.Collections.Generic.IReadOnlyDictionary<int, global::System.Collections.Generic.IReadOnlyDictionary<int, global::GenJson.Tests.EmptyClass>> _Present = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new NestedDictionaryClass
                    {
                        Present = _Present,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Present":
                        {
                            var dict0 = new global::System.Collections.Generic.Dictionary<int, global::System.Collections.Generic.IReadOnlyDictionary<int, global::GenJson.Tests.EmptyClass>>();
                            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                            while (index < json.Length)
                            {
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == '}')
                                {
                                    index++;
                                    _Present = dict0;
                                    break;
                                }
                                var keyStr0 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                int key0 = int.Parse(keyStr0);
                                global::System.Collections.Generic.IReadOnlyDictionary<int, global::GenJson.Tests.EmptyClass> val0 = default;
                                {
                                    var dict1 = new global::System.Collections.Generic.Dictionary<int, global::GenJson.Tests.EmptyClass>();
                                    global::GenJson.GenJsonParser.Expect(json, ref index, '{');
                                    while (index < json.Length)
                                    {
                                        global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                        if (json[index] == '}')
                                        {
                                            index++;
                                            val0 = dict1;
                                            break;
                                        }
                                        var keyStr1 = global::GenJson.GenJsonParser.ParseString(json, ref index);
                                        global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                                        int key1 = int.Parse(keyStr1);
                                        global::GenJson.Tests.EmptyClass val1 = default;
                                        val1 = global::GenJson.Tests.EmptyClass.Parse(json, ref index);
                                        dict1.Add(key1, val1);
                                        global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                        if (json[index] == ',')
                                        {
                                            index++;
                                        }
                                    }
                                }
                                dict0.Add(key0, val0);
                                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                                if (json[index] == ',')
                                {
                                    index++;
                                }
                            }
                        }
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

  
namespace GenJson.Tests
{
    partial class PrimitiveClass
    {
        public int CalculateJsonSize()
        {
            int size = 2;
            int propertyCount = 0;
            propertyCount++;
            size += 7;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Bool);
            propertyCount++;
            size += 6;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Int);
            propertyCount++;
            size += 7;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Uint);
            propertyCount++;
            size += 7;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Char);
            propertyCount++;
            size += 7;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Long);
            propertyCount++;
            size += 8;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Short);
            propertyCount++;
            size += 7;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Byte);
            propertyCount++;
            size += 8;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.SByte);
            propertyCount++;
            size += 8;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Float);
            propertyCount++;
            size += 9;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Double);
            propertyCount++;
            size += 10;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Decimal);
            propertyCount++;
            size += 9;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.String);
            propertyCount++;
            size += 11;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.DateTime);
            propertyCount++;
            size += 11;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.TimeSpan);
            propertyCount++;
            size += 11;
            {
                global::System.Span<char> buffer = stackalloc char[128];
                if (this.DateOnly.TryFormat(buffer, out int written, "O", global::System.Globalization.CultureInfo.InvariantCulture))
                {
                    size += written + 2;
                }
                else
                {
                    size += this.DateOnly.ToString("O", global::System.Globalization.CultureInfo.InvariantCulture).Length + 2;
                }
            }
            propertyCount++;
            size += 11;
            {
                global::System.Span<char> buffer = stackalloc char[128];
                if (this.TimeOnly.TryFormat(buffer, out int written, "O", global::System.Globalization.CultureInfo.InvariantCulture))
                {
                    size += written + 2;
                }
                else
                {
                    size += this.TimeOnly.ToString("O", global::System.Globalization.CultureInfo.InvariantCulture).Length + 2;
                }
            }
            propertyCount++;
            size += 17;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.DateTimeOffset);
            propertyCount++;
            size += 7;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Guid);
            propertyCount++;
            size += 10;
            size += global::GenJson.GenJsonSizeHelper.GetSize(this.Version);
            if (propertyCount > 0) size += propertyCount - 1;
            return size;
        }

        public string ToJson()
        {
            var sb = new System.Text.StringBuilder(CalculateJsonSize());
            this.ToJson(sb);
            return sb.ToString();
        }

        public void ToJson(System.Text.StringBuilder sb)
        {
            sb.Append("{");
            sb.Append("\"Bool\":");
            sb.Append(this.Bool ? "true" : "false");
            sb.Append(",");
            sb.Append("\"Int\":");
            sb.Append(this.Int);
            sb.Append(",");
            sb.Append("\"Uint\":");
            sb.Append(this.Uint);
            sb.Append(",");
            sb.Append("\"Char\":");
            sb.Append("\"");
            sb.Append(this.Char);
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"Long\":");
            sb.Append(this.Long);
            sb.Append(",");
            sb.Append("\"Short\":");
            sb.Append(this.Short);
            sb.Append(",");
            sb.Append("\"Byte\":");
            sb.Append(this.Byte);
            sb.Append(",");
            sb.Append("\"SByte\":");
            sb.Append(this.SByte);
            sb.Append(",");
            sb.Append("\"Float\":");
            {
                System.Span<char> buffer = stackalloc char[32];
                if (this.Float.TryFormat(buffer, out int written, "R", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.Float.ToString(System.Globalization.CultureInfo.InvariantCulture));
                }
            }
            sb.Append(",");
            sb.Append("\"Double\":");
            {
                System.Span<char> buffer = stackalloc char[32];
                if (this.Double.TryFormat(buffer, out int written, "R", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.Double.ToString(System.Globalization.CultureInfo.InvariantCulture));
                }
            }
            sb.Append(",");
            sb.Append("\"Decimal\":");
            {
                System.Span<char> buffer = stackalloc char[32];
                if (this.Decimal.TryFormat(buffer, out int written, "R", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.Decimal.ToString(System.Globalization.CultureInfo.InvariantCulture));
                }
            }
            sb.Append(",");
            sb.Append("\"String\":");
            sb.Append("\"");
            sb.Append(this.String);
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"DateTime\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[64];
                if (this.DateTime.TryFormat(buffer, out int written, "O", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.DateTime.ToString("O"));
                }
            }
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"TimeSpan\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[64];
                if (this.TimeSpan.TryFormat(buffer, out int written))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.TimeSpan.ToString());
                }
            }
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"DateOnly\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[64];
                if (this.DateOnly.TryFormat(buffer, out int written, "O", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.DateOnly.ToString("O"));
                }
            }
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"TimeOnly\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[64];
                if (this.TimeOnly.TryFormat(buffer, out int written, "O", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.TimeOnly.ToString("O"));
                }
            }
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"DateTimeOffset\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[64];
                if (this.DateTimeOffset.TryFormat(buffer, out int written, "O", System.Globalization.CultureInfo.InvariantCulture))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.DateTimeOffset.ToString("O"));
                }
            }
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"Guid\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[36];
                if (this.Guid.TryFormat(buffer, out int written))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.Guid.ToString());
                }
            }
            sb.Append("\"");
            sb.Append(",");
            sb.Append("\"Version\":");
            sb.Append("\"");
            {
                System.Span<char> buffer = stackalloc char[64];
                if (this.Version.TryFormat(buffer, out int written))
                {
                    sb.Append(buffer.Slice(0, written));
                }
                else
                {
                    sb.Append(this.Version.ToString());
                }
            }
            sb.Append("\"");
            sb.Append("}");
        }

        public static PrimitiveClass FromJson(string json)
        {
            if (json is null) throw new System.ArgumentNullException(nameof(json));
            System.ReadOnlySpan<char> span = json;
            var index = 0;
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            var result = Parse(span, ref index);
            global::GenJson.GenJsonParser.SkipWhitespace(span, ref index);
            if (index != span.Length) throw new System.ArgumentException("Unexpected extra characters", nameof(json));
            return result;
        }

        internal static PrimitiveClass Parse(System.ReadOnlySpan<char> json, ref int index)
        {
            global::GenJson.GenJsonParser.Expect(json, ref index, '{');
            bool _Bool = default;
            int _Int = default;
            uint _Uint = default;
            char _Char = default;
            long _Long = default;
            short _Short = default;
            byte _Byte = default;
            sbyte _SByte = default;
            float _Float = default;
            double _Double = default;
            decimal _Decimal = default;
            string _String = default;
            global::System.DateTime _DateTime = default;
            global::System.TimeSpan _TimeSpan = default;
            global::System.DateOnly _DateOnly = default;
            global::System.TimeOnly _TimeOnly = default;
            global::System.DateTimeOffset _DateTimeOffset = default;
            global::System.Guid _Guid = default;
            global::System.Version _Version = default;
            while (index < json.Length)
            {
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == '}')
                {
                    index++;
                    return new PrimitiveClass
                    {
                        Bool = _Bool,
                        Int = _Int,
                        Uint = _Uint,
                        Char = _Char,
                        Long = _Long,
                        Short = _Short,
                        Byte = _Byte,
                        SByte = _SByte,
                        Float = _Float,
                        Double = _Double,
                        Decimal = _Decimal,
                        String = _String,
                        DateTime = _DateTime,
                        TimeSpan = _TimeSpan,
                        DateOnly = _DateOnly,
                        TimeOnly = _TimeOnly,
                        DateTimeOffset = _DateTimeOffset,
                        Guid = _Guid,
                        Version = _Version,
                    };
                }
                var key = global::GenJson.GenJsonParser.ParseString(json, ref index);
                global::GenJson.GenJsonParser.Expect(json, ref index, ':');
                switch (key)
                {
                    case "Bool":
                        _Bool = global::GenJson.GenJsonParser.ParseBoolean(json, ref index);
                        break;
                    case "Int":
                        _Int = global::GenJson.GenJsonParser.ParseInt(json, ref index);
                        break;
                    case "Uint":
                        _Uint = global::GenJson.GenJsonParser.ParseUInt(json, ref index);
                        break;
                    case "Char":
                        _Char = global::GenJson.GenJsonParser.ParseChar(json, ref index);
                        break;
                    case "Long":
                        _Long = global::GenJson.GenJsonParser.ParseLong(json, ref index);
                        break;
                    case "Short":
                        _Short = global::GenJson.GenJsonParser.ParseShort(json, ref index);
                        break;
                    case "Byte":
                        _Byte = global::GenJson.GenJsonParser.ParseByte(json, ref index);
                        break;
                    case "SByte":
                        _SByte = global::GenJson.GenJsonParser.ParseSByte(json, ref index);
                        break;
                    case "Float":
                        _Float = global::GenJson.GenJsonParser.ParseFloat(json, ref index);
                        break;
                    case "Double":
                        _Double = global::GenJson.GenJsonParser.ParseDouble(json, ref index);
                        break;
                    case "Decimal":
                        _Decimal = global::GenJson.GenJsonParser.ParseDecimal(json, ref index);
                        break;
                    case "String":
                        _String = global::GenJson.GenJsonParser.ParseString(json, ref index);
                        break;
                    case "DateTime":
                        _DateTime = System.DateTime.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index), System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.RoundtripKind);
                        break;
                    case "TimeSpan":
                        _TimeSpan = System.TimeSpan.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index));
                        break;
                    case "DateOnly":
                        _DateOnly = System.DateOnly.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index));
                        break;
                    case "TimeOnly":
                        _TimeOnly = System.TimeOnly.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index));
                        break;
                    case "DateTimeOffset":
                        _DateTimeOffset = System.DateTimeOffset.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index), System.Globalization.CultureInfo.InvariantCulture);
                        break;
                    case "Guid":
                        _Guid = System.Guid.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index));
                        break;
                    case "Version":
                        _Version = System.Version.Parse(global::GenJson.GenJsonParser.ParseString(json, ref index));
                        break;
                    default:
                        global::GenJson.GenJsonParser.SkipValue(json, ref index);
                        break;
                }
                global::GenJson.GenJsonParser.SkipWhitespace(json, ref index);
                if (json[index] == ',')
                {
                    index++;
                }
            }
            throw new System.Exception("Unterminated object at " + index);
        }
    }
}

]